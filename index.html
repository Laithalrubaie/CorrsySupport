<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Corrsy Support ‚Ä¢ ÿØÿπŸÖ ŸÉŸàÿ±ÿ≥Ÿä</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
    
    <style>
        /* Instagram-inspired Color Palette */
        :root {
            --instagram-gradient: linear-gradient(45deg, #f09433 0%, #e6683c 25%, #dc2743 50%, #cc2366 75%, #bc1888 100%);
            --primary: #405DE6;
            --primary-light: #5B86E5;
            --secondary: #FD1D1D;
            --accent: #FFDC80;
            --success: #00B894;
            --warning: #FDCB6E;
            --danger: #E17055;
            --purple: #6C5CE7;
            --pink: #FD79A8;
            --teal: #00CEC9;
            --bg-gradient: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            --card-bg: rgba(255, 255, 255, 0.95);
            --card-shadow: 0 8px 32px rgba(31, 38, 135, 0.1);
            --glass-bg: rgba(255, 255, 255, 0.7);
            --glass-border: rgba(255, 255, 255, 0.18);
            --text-dark: #2D3436;
            --text-light: #636E72;
            --radius-lg: 20px;
            --radius-md: 15px;
            --radius-sm: 10px;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, 'Noto Sans Arabic', 'SF Pro Display', sans-serif;
            background: var(--bg-gradient);
            color: var(--text-dark);
            line-height: 1.6;
            min-height: 100vh;
            direction: rtl;
            overflow-x: hidden;
        }
        
        /* Animated Background */
        .bg-animation {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            overflow: hidden;
        }
        
        .bubble {
            position: absolute;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            animation: float 15s infinite ease-in-out;
        }
        
        .bubble:nth-child(1) {
            width: 80px;
            height: 80px;
            top: 20%;
            left: 10%;
            animation-delay: 0s;
            background: rgba(64, 93, 230, 0.1);
        }
        
        .bubble:nth-child(2) {
            width: 120px;
            height: 120px;
            top: 60%;
            right: 15%;
            animation-delay: -5s;
            background: rgba(253, 29, 29, 0.1);
        }
        
        .bubble:nth-child(3) {
            width: 60px;
            height: 60px;
            bottom: 30%;
            left: 20%;
            animation-delay: -10s;
            background: rgba(108, 92, 231, 0.1);
        }
        
        .bubble:nth-child(4) {
            width: 90px;
            height: 90px;
            top: 40%;
            right: 25%;
            animation-delay: -3s;
            background: rgba(0, 184, 148, 0.1);
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(180deg); }
        }
        
        /* Main Container - Instagram Mobile Layout */
        .container {
            max-width: 500px;
            margin: 0 auto;
            padding: 15px;
            position: relative;
            z-index: 1;
        }
        
        /* Instagram Stories Style */
        .stories-container {
            display: flex;
            gap: 15px;
            padding: 15px;
            overflow-x: auto;
            margin-bottom: 20px;
            scrollbar-width: none;
        }
        
        .stories-container::-webkit-scrollbar {
            display: none;
        }
        
        .story {
            flex: 0 0 auto;
            width: 70px;
            text-align: center;
            cursor: pointer;
            transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
        }
        
        .story:hover {
            transform: scale(1.1);
        }
        
        .story-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            padding: 3px;
            background: var(--instagram-gradient);
            margin: 0 auto 8px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .story-avatar-inner {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }
        
        .story-text {
            font-size: 0.75rem;
            font-weight: 600;
            color: var(--text-dark);
            white-space: nowrap;
        }
        
        /* Instagram Header */
        .insta-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            background: var(--card-bg);
            backdrop-filter: blur(10px);
            border-radius: var(--radius-lg);
            margin-bottom: 20px;
            box-shadow: var(--card-shadow);
            animation: slideDown 0.5s ease-out;
        }
        
        @keyframes slideDown {
            from { transform: translateY(-20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        .insta-logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 800;
            font-size: 1.5rem;
            background: var(--instagram-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .insta-actions {
            display: flex;
            gap: 15px;
        }
        
        .insta-action-btn {
            background: none;
            border: none;
            font-size: 1.3rem;
            color: var(--text-dark);
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            padding: 5px;
        }
        
        .insta-action-btn:hover {
            transform: scale(1.1);
            color: var(--primary);
        }
        
        .insta-action-btn.notification::after {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 8px;
            height: 8px;
            background: var(--secondary);
            border-radius: 50%;
            border: 2px solid white;
        }
        
        /* Main Content Tabs */
        .tabs-container {
            display: flex;
            background: var(--card-bg);
            border-radius: var(--radius-lg);
            margin-bottom: 20px;
            overflow: hidden;
            box-shadow: var(--card-shadow);
        }
        
        .tab {
            flex: 1;
            text-align: center;
            padding: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            color: var(--text-light);
        }
        
        .tab.active {
            color: var(--primary);
            background: rgba(64, 93, 230, 0.1);
        }
        
        .tab.active::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 60%;
            height: 3px;
            background: var(--instagram-gradient);
            border-radius: 2px;
        }
        
        /* Instagram Card Style */
        .insta-card {
            background: var(--card-bg);
            border-radius: var(--radius-lg);
            margin-bottom: 20px;
            overflow: hidden;
            box-shadow: var(--card-shadow);
            animation: fadeInUp 0.5s ease-out;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            border: 1px solid var(--glass-border);
        }
        
        .insta-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(31, 38, 135, 0.15);
        }
        
        @keyframes fadeInUp {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            background: rgba(255, 255, 255, 0.9);
        }
        
        .user-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--instagram-gradient);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }
        
        .user-name {
            font-weight: 600;
            color: var(--text-dark);
        }
        
        .category-badge {
            font-size: 0.7rem;
            font-weight: 700;
            padding: 5px 12px;
            border-radius: 20px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            background: var(--instagram-gradient);
            color: white;
        }
        
        .card-content {
            padding: 15px;
        }
        
        .card-title {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--text-dark);
            margin-bottom: 10px;
            line-height: 1.4;
        }
        
        .keywords {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 15px;
        }
        
        .keyword {
            background: rgba(64, 93, 230, 0.1);
            color: var(--primary);
            padding: 4px 10px;
            border-radius: 15px;
            font-size: 0.75rem;
            font-weight: 500;
        }
        
        .agent-note {
            background: linear-gradient(135deg, #fff9e6, #ffeaa7);
            border-right: 4px solid var(--warning);
            padding: 12px 15px;
            border-radius: var(--radius-sm);
            font-size: 0.85rem;
            color: #6b4700;
            margin-bottom: 15px;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.02); }
        }
        
        .reply-section {
            position: relative;
            margin-top: 15px;
        }
        
        .reply-box {
            background: linear-gradient(135deg, #f0f9ff, #e6f7ff);
            border: 2px solid rgba(64, 93, 230, 0.2);
            padding: 20px;
            border-radius: var(--radius-md);
            font-size: 0.9rem;
            line-height: 1.6;
            white-space: pre-wrap;
            position: relative;
            min-height: 120px;
            text-align: right;
            direction: rtl;
        }
        
        /* Copy Button - Instagram Style */
        .copy-btn {
            position: absolute;
            top: 10px;
            left: 10px;
            background: var(--glass-bg);
            backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
            color: var(--primary);
            padding: 8px 12px;
            border-radius: var(--radius-sm);
            cursor: pointer;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 5px;
            transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
            z-index: 10;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            font-size: 0.85rem;
        }
        
        .copy-btn:hover {
            transform: scale(1.05) translateY(-2px);
            background: var(--primary);
            color: white;
            box-shadow: 0 8px 25px rgba(64, 93, 230, 0.3);
        }
        
        .copy-btn.copied {
            background: var(--success);
            color: white;
            border-color: var(--success);
            animation: bounce 0.5s;
        }
        
        @keyframes bounce {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
        
        .card-footer {
            padding: 15px;
            background: rgba(248, 249, 250, 0.8);
            border-top: 1px solid rgba(0, 0, 0, 0.05);
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.8rem;
            color: var(--text-light);
        }
        
        .timestamp {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .card-actions {
            display: flex;
            gap: 15px;
        }
        
        .card-action-btn {
            background: none;
            border: none;
            color: var(--text-light);
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 0.9rem;
        }
        
        .card-action-btn:hover {
            color: var(--primary);
            transform: translateY(-2px);
        }
        
        .card-action-btn.like:hover {
            color: var(--secondary);
        }
        
        .card-action-btn.share:hover {
            color: var(--success);
        }
        
        /* Websites Section - Instagram Highlights Style */
        .websites-section {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .website-card {
            background: var(--card-bg);
            border-radius: var(--radius-lg);
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
            border: 2px solid transparent;
            box-shadow: var(--card-shadow);
            animation: fadeIn 0.5s ease-out;
        }
        
        .website-card:hover {
            transform: translateY(-8px) scale(1.05);
            border-color: var(--primary);
            box-shadow: 0 15px 35px rgba(64, 93, 230, 0.2);
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: scale(0.9); }
            to { opacity: 1; transform: scale(1); }
        }
        
        .website-icon {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: var(--instagram-gradient);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 15px;
            font-size: 1.5rem;
            color: white;
            transition: transform 0.3s ease;
        }
        
        .website-card:hover .website-icon {
            transform: rotate(360deg);
        }
        
        .website-name {
            font-weight: 700;
            margin-bottom: 8px;
            color: var(--text-dark);
        }
        
        .website-desc {
            font-size: 0.8rem;
            color: var(--text-light);
            line-height: 1.4;
        }
        
        /* Admin Panel - Instagram Story Creator Style */
        #adminPanel {
            display: none;
            background: var(--card-bg);
            border-radius: var(--radius-lg);
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: var(--card-shadow);
            animation: slideUp 0.5s ease-out;
            border: 2px solid rgba(64, 93, 230, 0.2);
        }
        
        @keyframes slideUp {
            from { transform: translateY(30px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        .admin-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid rgba(0, 0, 0, 0.05);
        }
        
        .admin-title {
            font-size: 1.3rem;
            font-weight: 800;
            background: var(--instagram-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .admin-form {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .form-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .form-label {
            font-weight: 600;
            color: var(--text-dark);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .form-input, .form-textarea, .form-select {
            padding: 15px;
            border: 2px solid rgba(0, 0, 0, 0.1);
            border-radius: var(--radius-md);
            font-family: inherit;
            font-size: 1rem;
            transition: all 0.3s ease;
            background: rgba(255, 255, 255, 0.9);
        }
        
        .form-input:focus, .form-textarea:focus, .form-select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(64, 93, 230, 0.2);
            transform: translateY(-2px);
        }
        
        .form-textarea {
            resize: vertical;
            min-height: 120px;
        }
        
        .form-actions {
            display: flex;
            gap: 15px;
            justify-content: flex-end;
            margin-top: 20px;
        }
        
        .btn {
            padding: 12px 25px;
            border-radius: var(--radius-md);
            border: none;
            cursor: pointer;
            font-weight: 700;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .btn-primary {
            background: var(--instagram-gradient);
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(220, 39, 67, 0.3);
        }
        
        .btn-secondary {
            background: rgba(0, 0, 0, 0.05);
            color: var(--text-dark);
        }
        
        .btn-secondary:hover {
            background: rgba(0, 0, 0, 0.1);
            transform: translateY(-2px);
        }
        
        .btn-danger {
            background: linear-gradient(135deg, #FF416C, #FF4B2B);
            color: white;
        }
        
        .btn-danger:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(255, 65, 108, 0.3);
        }
        
        /* Login Modal - Instagram Auth Style */
        #loginModal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            justify-content: center;
            align-items: center;
            z-index: 1000;
            animation: fadeIn 0.3s ease-out;
            backdrop-filter: blur(10px);
        }
        
        .modal-content {
            background: var(--card-bg);
            padding: 30px;
            border-radius: var(--radius-lg);
            width: 90%;
            max-width: 400px;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.25);
            animation: scaleIn 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
        }
        
        @keyframes scaleIn {
            from { transform: scale(0.8); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
        
        .modal-header {
            text-align: center;
            margin-bottom: 25px;
        }
        
        .modal-logo {
            font-size: 2rem;
            font-weight: 800;
            background: var(--instagram-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
        }
        
        .modal-subtitle {
            color: var(--text-light);
            font-size: 0.9rem;
        }
        
        /* Loading Animation */
        .loading-spinner {
            display: inline-block;
            width: 30px;
            height: 30px;
            border: 3px solid rgba(0, 0, 0, 0.1);
            border-radius: 50%;
            border-top-color: var(--primary);
            animation: spin 1s ease-in-out infinite;
        }
        
        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            animation: fadeIn 0.5s ease-out;
        }
        
        .empty-icon {
            font-size: 4rem;
            background: var(--instagram-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 20px;
        }
        
        .empty-title {
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 10px;
            color: var(--text-dark);
        }
        
        .empty-subtitle {
            color: var(--text-light);
            margin-bottom: 20px;
        }
        
        /* Toast Notification - Instagram Story Style */
        #toast {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%) translateY(100px);
            background: var(--instagram-gradient);
            color: white;
            padding: 15px 25px;
            border-radius: var(--radius-lg);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            display: flex;
            align-items: center;
            gap: 10px;
            z-index: 1001;
            opacity: 0;
            transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
        }
        
        #toast.show {
            transform: translateX(-50%) translateY(0);
            opacity: 1;
        }
        
        /* Scrollbar Styling */
        ::-webkit-scrollbar {
            width: 6px;
        }
        
        ::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.05);
            border-radius: 10px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: var(--instagram-gradient);
            border-radius: 10px;
        }
        
        /* Mobile Responsive */
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .insta-header {
                padding: 12px;
                margin-bottom: 15px;
            }
            
            .story {
                width: 65px;
            }
            
            .story-avatar {
                width: 55px;
                height: 55px;
            }
            
            .insta-card {
                margin-bottom: 15px;
            }
            
            .card-header {
                padding: 12px;
            }
            
            .card-content {
                padding: 12px;
            }
            
            .reply-box {
                padding: 15px;
                min-height: 100px;
            }
            
            .copy-btn {
                padding: 6px 10px;
                font-size: 0.8rem;
            }
            
            .websites-section {
                grid-template-columns: repeat(2, 1fr);
                gap: 10px;
            }
            
            .website-card {
                padding: 15px;
            }
            
            .website-icon {
                width: 50px;
                height: 50px;
                font-size: 1.3rem;
            }
            
            .btn {
                padding: 10px 20px;
                font-size: 0.85rem;
            }
            
            .modal-content {
                padding: 20px;
            }
        }
        
        @media (max-width: 480px) {
            .stories-container {
                padding: 10px;
                gap: 10px;
            }
            
            .story {
                width: 60px;
            }
            
            .story-avatar {
                width: 50px;
                height: 50px;
            }
            
            .story-text {
                font-size: 0.7rem;
            }
            
            .websites-section {
                grid-template-columns: 1fr;
            }
            
            .tabs-container {
                flex-direction: column;
            }
            
            .tab {
                padding: 12px;
            }
            
            .form-actions {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
                justify-content: center;
            }
        }
        
        /* Swipe Animation */
        .swipe-left {
            animation: swipeLeft 0.3s ease-out forwards;
        }
        
        @keyframes swipeLeft {
            from { transform: translateX(0); opacity: 1; }
            to { transform: translateX(-100%); opacity: 0; }
        }
        
        .swipe-right {
            animation: swipeRight 0.3s ease-out forwards;
        }
        
        @keyframes swipeRight {
            from { transform: translateX(0); opacity: 1; }
            to { transform: translateX(100%); opacity: 0; }
        }
        
        /* Heart Animation */
        .heart-animation {
            position: absolute;
            pointer-events: none;
            font-size: 2rem;
            color: var(--secondary);
            animation: floatUp 1s ease-out forwards;
        }
        
        @keyframes floatUp {
            0% { transform: translateY(0) scale(0); opacity: 1; }
            100% { transform: translateY(-100px) scale(1.5); opacity: 0; }
        }
    </style>
</head>
<body>

<!-- Animated Background -->
<div class="bg-animation">
    <div class="bubble"></div>
    <div class="bubble"></div>
    <div class="bubble"></div>
    <div class="bubble"></div>
</div>

<!-- Login Modal -->
<div id="loginModal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <div class="modal-logo">üì± Corrsy Admin</div>
            <p class="modal-subtitle">Login to manage support tickets</p>
        </div>
        <div class="modal-body">
            <div class="form-group">
                <input type="email" id="email" class="form-input" placeholder="Email" autocomplete="username">
            </div>
            <div class="form-group">
                <input type="password" id="password" class="form-input" placeholder="Password" autocomplete="current-password">
            </div>
            <div id="loginError" style="color: var(--danger); font-size: 0.9rem; margin-top: 10px; display: none;">
                Invalid email or password
            </div>
        </div>
        <div class="modal-actions">
            <button onclick="login()" class="btn btn-primary" style="flex: 1;" id="loginBtn">
                <span id="loginBtnText">Login</span>
                <span id="loginSpinner" class="loading-spinner" style="display: none;"></span>
            </button>
            <button onclick="closeLoginModal()" class="btn btn-secondary" style="flex: 1;">Cancel</button>
        </div>
    </div>
</div>

<!-- Toast Notification -->
<div id="toast">
    <i class="fas fa-check-circle"></i>
    <span id="toastMessage">Copied to clipboard!</span>
</div>

<!-- Main Container -->
<div class="container">
    <!-- Instagram Header -->
    <div class="insta-header">
        <div class="insta-logo">
            <i class="fas fa-headset"></i>
            <span>Corrsy Support</span>
        </div>
        <div class="insta-actions">
            <button class="insta-action-btn" onclick="refreshTickets()" title="Refresh">
                <i class="fas fa-sync-alt"></i>
            </button>
            <button id="authBtn" onclick="toggleAuth()" class="insta-action-btn" title="Admin">
                <i class="fas fa-user-cog"></i>
            </button>
            <button class="insta-action-btn notification" onclick="showNotifications()" title="Notifications">
                <i class="fas fa-bell"></i>
            </button>
        </div>
    </div>

    <!-- Instagram Stories (Categories) -->
    <div class="stories-container">
        <div class="story" onclick="filter('all', this)">
            <div class="story-avatar">
                <div class="story-avatar-inner">üìö</div>
            </div>
            <div class="story-text">All</div>
        </div>
        <div class="story" onclick="filter('sop', this)">
            <div class="story-avatar">
                <div class="story-avatar-inner">üí¨</div>
            </div>
            <div class="story-text">SOP</div>
        </div>
        <div class="story" onclick="filter('code', this)">
            <div class="story-avatar">
                <div class="story-avatar-inner">üîë</div>
            </div>
            <div class="story-text">Codes</div>
        </div>
        <div class="story" onclick="filter('tech', this)">
            <div class="story-avatar">
                <div class="story-avatar-inner">üîß</div>
            </div>
            <div class="story-text">Tech</div>
        </div>
        <div class="story" onclick="filter('login', this)">
            <div class="story-avatar">
                <div class="story-avatar-inner">üë§</div>
            </div>
            <div class="story-text">Login</div>
        </div>
    </div>

    <!-- Main Tabs -->
    <div class="tabs-container">
        <div class="tab active" onclick="showTab('tickets')">
            <i class="fas fa-ticket-alt"></i> Tickets
        </div>
        <div class="tab" onclick="showTab('websites')">
            <i class="fas fa-globe"></i> Websites
        </div>
        <div class="tab" onclick="showTab('stats')">
            <i class="fas fa-chart-bar"></i> Stats
        </div>
    </div>

    <!-- Admin Panel -->
    <div id="adminPanel">
        <div class="admin-header">
            <div class="admin-title">
                <i class="fas fa-plus-circle"></i> Create New Ticket
            </div>
            <button onclick="clearForm()" class="btn btn-secondary">
                <i class="fas fa-times"></i> Clear
            </button>
        </div>
        
        <input type="hidden" id="docId">
        
        <div class="admin-form">
            <div class="form-group">
                <label for="inpTitle"><i class="fas fa-heading"></i> Ticket Title</label>
                <input type="text" id="inpTitle" class="form-input" placeholder="What's the issue?">
            </div>
            
            <div class="form-group">
                <label for="inpCategory"><i class="fas fa-tag"></i> Category</label>
                <select id="inpCategory" class="form-select">
                    <option value="sop">üí¨ SOP / Leads</option>
                    <option value="code">üîë Code & Activation</option>
                    <option value="login">üë§ Login & Account</option>
                    <option value="tech">üîß Technical Issues</option>
                    <option value="content">üìö Content/Lectures</option>
                    <option value="inquiry">‚ùì General Inquiries</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="inpKeywords"><i class="fas fa-key"></i> Keywords</label>
                <input type="text" id="inpKeywords" class="form-input" placeholder="Separate with commas">
            </div>
            
            <div class="form-group">
                <label for="inpNote"><i class="fas fa-exclamation-triangle"></i> Agent Note</label>
                <textarea id="inpNote" class="form-textarea" placeholder="Special instructions for agents..."></textarea>
            </div>
            
            <div class="form-group">
                <label for="inpReply"><i class="fas fa-comment-dots"></i> Reply Script</label>
                <textarea id="inpReply" class="form-textarea" placeholder="The reply script for students..."></textarea>
            </div>
            
            <div class="form-group">
                <label for="inpSLA"><i class="fas fa-clock"></i> SLA Time</label>
                <input type="text" id="inpSLA" class="form-input" placeholder="e.g., 2 hours">
            </div>
        </div>
        
        <div class="form-actions">
            <button onclick="deleteTicket()" class="btn btn-danger" id="deleteBtn" style="display: none;">
                <i class="fas fa-trash"></i> Delete
            </button>
            <button onclick="clearForm()" class="btn btn-secondary">
                <i class="fas fa-times"></i> Cancel
            </button>
            <button onclick="saveTicket()" class="btn btn-primary" id="saveBtn">
                <i class="fas fa-save"></i> <span id="saveBtnText">Save Ticket</span>
            </button>
        </div>
    </div>

    <!-- Tickets Tab Content -->
    <div id="ticketsTab">
        <div id="ticketsGrid"></div>
    </div>

    <!-- Websites Tab Content -->
    <div id="websitesTab" style="display: none;">
        <div class="websites-section">
            <!-- Websites will be loaded here -->
        </div>
    </div>

    <!-- Stats Tab Content -->
    <div id="statsTab" style="display: none;">
        <div class="insta-card">
            <div class="card-content">
                <h3 class="card-title">üìä Support Statistics</h3>
                <div id="statsContent">
                    <div style="text-align: center; padding: 30px;">
                        <div class="loading-spinner"></div>
                        <p style="margin-top: 15px; color: var(--text-light);">Loading statistics...</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    // ==========================================
    // üî¥ FIREBASE CONFIG
    // ==========================================
    const firebaseConfig = {
        apiKey: "AIzaSyA_dD-J3eELADFp1LTe6x2bcrnLw1G6hGI",
        authDomain: "corrsysupport.firebaseapp.com",
        projectId: "corrsysupport",
        storageBucket: "corrsysupport.firebasestorage.app",
        messagingSenderId: "926063390426",
        appId: "1:926063390426:web:506905b8421a8b4ea3bfe3",
    };
    
    // ==========================================
    // INITIALIZATION
    // ==========================================
    let app;
    let db;
    let auth;
    let tickets = [];
    let currentCategory = 'all';
    let currentTab = 'tickets';
    let isAdmin = false;
    let websites = [
        {
            name: "Corrsy Platform",
            url: "https://app.corrsy.com",
            icon: "fas fa-graduation-cap",
            description: "Main learning platform for students",
            color: "#405DE6"
        },
        {
            name: "Admin Dashboard",
            url: "https://admin.corrsy.com",
            icon: "fas fa-tachometer-alt",
            description: "Administrator control panel",
            color: "#FD1D1D"
        },
        {
            name: "Student Portal",
            url: "https://students.corrsy.com",
            icon: "fas fa-user-graduate",
            description: "Student accounts and progress",
            color: "#00B894"
        },
        {
            name: "Code Activation",
            url: "https://activate.corrsy.com",
            icon: "fas fa-key",
            description: "Activate course access codes",
            color: "#6C5CE7"
        },
        {
            name: "Support Tickets",
            url: "https://support.corrsy.com",
            icon: "fas fa-headset",
            description: "Create and manage support tickets",
            color: "#FDCB6E"
        },
        {
            name: "Payment Portal",
            url: "https://pay.corrsy.com",
            icon: "fas fa-credit-card",
            description: "Payment processing and invoices",
            color: "#E17055"
        },
        {
            name: "Content Library",
            url: "https://content.corrsy.com",
            icon: "fas fa-video",
            description: "Course videos and materials",
            color: "#FD79A8"
        },
        {
            name: "Analytics",
            url: "https://analytics.corrsy.com",
            icon: "fas fa-chart-line",
            description: "Performance analytics and reports",
            color: "#00CEC9"
        }
    ];
    
    // Initialize Firebase
    try {
        app = firebase.initializeApp(firebaseConfig);
        db = firebase.firestore();
        auth = firebase.auth();
        console.log('Firebase initialized successfully');
    } catch (error) {
        console.error('Firebase initialization error:', error);
        showToast('Failed to connect to database', 'error');
    }
    
    // ==========================================
    // FIREBASE LISTENER
    // ==========================================
    function setupFirebaseListener() {
        if (!db) return;
        
        db.collection("tickets")
            .onSnapshot((snapshot) => {
                tickets = snapshot.docs.map(doc => { 
                    const data = doc.data();
                    return {
                        id: doc.id, 
                        ...data,
                        timestamp: data.timestamp ? data.timestamp.toDate() : new Date(),
                        order: data.order || 999,
                        title: data.title || 'No Title',
                        keywords: data.keywords || '',
                        note: data.note || '',
                        reply: data.reply || 'No reply script provided',
                        category: data.category || 'inquiry',
                        sla: data.sla || '',
                        likes: data.likes || 0,
                        shares: data.shares || 0
                    };
                });
                
                renderTickets();
                renderStats();
                
            }, (error) => {
                console.error('Firestore error:', error);
                showToast('Error loading tickets', 'error');
            });
    }
    
    // ==========================================
    // RENDER FUNCTIONS
    // ==========================================
    function renderTickets() {
        const grid = document.getElementById('ticketsGrid');
        const filteredTickets = tickets.filter(ticket => 
            currentCategory === 'all' || ticket.category === currentCategory
        );
        
        if (filteredTickets.length === 0) {
            grid.innerHTML = `
                <div class="empty-state">
                    <div class="empty-icon">üì≠</div>
                    <div class="empty-title">No tickets found</div>
                    <p class="empty-subtitle">Try selecting a different category</p>
                    ${isAdmin ? '<button onclick="clearForm()" class="btn btn-primary" style="margin-top: 20px;"><i class="fas fa-plus"></i> Create New Ticket</button>' : ''}
                </div>
            `;
            return;
        }
        
        // Sort by order
        filteredTickets.sort((a, b) => (a.order || 999) - (b.order || 999));
        
        grid.innerHTML = filteredTickets.map(ticket => `
            <div class="insta-card" id="card-${ticket.id}">
                <div class="card-header">
                    <div class="user-info">
                        <div class="user-avatar" style="background: ${getCategoryColor(ticket.category)};">
                            ${getCategoryIcon(ticket.category)}
                        </div>
                        <div>
                            <div class="user-name">${escapeHtml(ticket.title)}</div>
                            <div style="font-size: 0.8rem; color: var(--text-light);">
                                ${formatDate(ticket.timestamp)}
                            </div>
                        </div>
                    </div>
                    <span class="category-badge" style="background: ${getCategoryColor(ticket.category)};">
                        ${getCategoryName(ticket.category)}
                    </span>
                </div>
                
                <div class="card-content">
                    ${ticket.keywords ? `
                    <div class="keywords">
                        ${ticket.keywords.split(',').map(k => k.trim()).filter(k => k).map(keyword => 
                            `<span class="keyword">${escapeHtml(keyword)}</span>`
                        ).join('')}
                    </div>
                    ` : ''}
                    
                    ${ticket.note ? `
                    <div class="agent-note">
                        <i class="fas fa-exclamation-circle"></i>
                        <div>${escapeHtml(ticket.note)}</div>
                    </div>
                    ` : ''}
                    
                    <div class="reply-section">
                        <button class="copy-btn" onclick="copyText('${ticket.id}', this)" title="Copy reply">
                            <i class="fas fa-copy"></i> Copy
                        </button>
                        <div class="reply-box" id="reply-${ticket.id}">${escapeHtml(ticket.reply)}</div>
                    </div>
                </div>
                
                <div class="card-footer">
                    <div class="timestamp">
                        <i class="far fa-clock"></i>
                        ${ticket.sla ? `SLA: ${ticket.sla}` : 'No SLA'}
                    </div>
                    <div class="card-actions">
                        <button class="card-action-btn like" onclick="likeTicket('${ticket.id}', this)">
                            <i class="fas fa-heart"></i>
                            <span>${ticket.likes || 0}</span>
                        </button>
                        <button class="card-action-btn share" onclick="shareTicket('${ticket.id}')">
                            <i class="fas fa-share"></i>
                            <span>${ticket.shares || 0}</span>
                        </button>
                        ${isAdmin ? `
                        <button class="card-action-btn" onclick="editTicket('${ticket.id}')" title="Edit">
                            <i class="fas fa-edit"></i>
                        </button>
                        ` : ''}
                    </div>
                </div>
            </div>
        `).join('');
    }
    
    function renderWebsites() {
        const websitesSection = document.querySelector('#websitesTab .websites-section');
        websitesSection.innerHTML = websites.map(website => `
            <div class="website-card" onclick="openWebsite('${website.url}')">
                <div class="website-icon" style="background: ${website.color};">
                    <i class="${website.icon}"></i>
                </div>
                <div class="website-name">${website.name}</div>
                <div class="website-desc">${website.description}</div>
            </div>
        `).join('');
    }
    
    function renderStats() {
        const statsContent = document.getElementById('statsContent');
        const totalTickets = tickets.length;
        const categories = {};
        
        tickets.forEach(ticket => {
            categories[ticket.category] = (categories[ticket.category] || 0) + 1;
        });
        
        statsContent.innerHTML = `
            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px;">
                <div style="background: linear-gradient(135deg, #405DE6, #5B86E5); padding: 20px; border-radius: var(--radius-md); color: white; text-align: center;">
                    <div style="font-size: 2rem; font-weight: 800;">${totalTickets}</div>
                    <div style="font-size: 0.9rem;">Total Tickets</div>
                </div>
                <div style="background: linear-gradient(135deg, #00B894, #00CEC9); padding: 20px; border-radius: var(--radius-md); color: white; text-align: center;">
                    <div style="font-size: 2rem; font-weight: 800;">${categories.sop || 0}</div>
                    <div style="font-size: 0.9rem;">SOP Scripts</div>
                </div>
            </div>
            
            <div style="margin-top: 20px;">
                <h4 style="margin-bottom: 15px; color: var(--text-dark);">Category Distribution</h4>
                ${Object.entries(categories).map(([cat, count]) => `
                    <div style="margin-bottom: 10px;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                            <span>${getCategoryName(cat)}</span>
                            <span style="font-weight: 600;">${count}</span>
                        </div>
                        <div style="height: 8px; background: rgba(0,0,0,0.1); border-radius: 4px; overflow: hidden;">
                            <div style="height: 100%; width: ${(count/totalTickets)*100}%; background: ${getCategoryColor(cat)}; border-radius: 4px;"></div>
                        </div>
                    </div>
                `).join('')}
            </div>
        `;
    }
    
    // ==========================================
    // INTERACTION FUNCTIONS
    // ==========================================
    function filter(cat, element) {
        currentCategory = cat;
        
        // Update active story
        document.querySelectorAll('.story').forEach(story => {
            story.style.opacity = '0.6';
        });
        element.style.opacity = '1';
        
        // Add animation to story
        element.style.transform = 'scale(0.9)';
        setTimeout(() => {
            element.style.transform = 'scale(1)';
        }, 300);
        
        renderTickets();
    }
    
    function showTab(tabName) {
        currentTab = tabName;
        
        // Update tabs
        document.querySelectorAll('.tab').forEach(tab => {
            tab.classList.remove('active');
        });
        event.target.closest('.tab').classList.add('active');
        
        // Show/hide content
        document.getElementById('ticketsTab').style.display = 'none';
        document.getElementById('websitesTab').style.display = 'none';
        document.getElementById('statsTab').style.display = 'none';
        document.getElementById(tabName + 'Tab').style.display = 'block';
        
        // Load content if needed
        if (tabName === 'websites') {
            renderWebsites();
        } else if (tabName === 'stats') {
            renderStats();
        }
    }
    
    function copyText(ticketId, button) {
        const replyElement = document.getElementById(`reply-${ticketId}`);
        const text = replyElement.textContent;
        
        navigator.clipboard.writeText(text).then(() => {
            // Button animation
            button.classList.add('copied');
            button.innerHTML = '<i class="fas fa-check"></i> Copied!';
            
            // Create heart animation
            createHeartAnimation(button);
            
            // Show toast
            showToast('Reply copied to clipboard!', 'success');
            
            // Reset button after 2 seconds
            setTimeout(() => {
                button.classList.remove('copied');
                button.innerHTML = '<i class="fas fa-copy"></i> Copy';
            }, 2000);
            
        }).catch(err => {
            showToast('Failed to copy text', 'error');
        });
    }
    
    function likeTicket(ticketId, button) {
        const ticket = tickets.find(t => t.id === ticketId);
        if (!ticket) return;
        
        // Create heart animation
        createHeartAnimation(button);
        
        // Update UI immediately
        const heartIcon = button.querySelector('i');
        const countSpan = button.querySelector('span');
        
        heartIcon.style.color = 'var(--secondary)';
        heartIcon.classList.remove('far');
        heartIcon.classList.add('fas');
        
        const currentLikes = parseInt(countSpan.textContent) || 0;
        countSpan.textContent = currentLikes + 1;
        
        // Update in database if admin
        if (isAdmin) {
            db.collection("tickets").doc(ticketId).update({
                likes: firebase.firestore.FieldValue.increment(1)
            });
        }
        
        // Card bounce animation
        const card = document.getElementById(`card-${ticketId}`);
        card.style.transform = 'scale(0.98)';
        setTimeout(() => {
            card.style.transform = 'scale(1)';
        }, 300);
    }
    
    function shareTicket(ticketId) {
        const ticket = tickets.find(t => t.id === ticketId);
        if (!ticket) return;
        
        const button = event.target.closest('button');
        const countSpan = button.querySelector('span');
        const currentShares = parseInt(countSpan.textContent) || 0;
        countSpan.textContent = currentShares + 1;
        
        // Button animation
        button.style.transform = 'scale(0.9)';
        setTimeout(() => {
            button.style.transform = 'scale(1)';
        }, 300);
        
        // Share animation
        const card = document.getElementById(`card-${ticketId}`);
        card.classList.add('swipe-right');
        setTimeout(() => {
            card.classList.remove('swipe-right');
        }, 300);
        
        // Update in database if admin
        if (isAdmin) {
            db.collection("tickets").doc(ticketId).update({
                shares: firebase.firestore.FieldValue.increment(1)
            });
        }
        
        showToast('Ticket shared!', 'success');
    }
    
    function openWebsite(url) {
        // Card animation
        const card = event.target.closest('.website-card');
        card.style.transform = 'scale(0.95)';
        
        // Open in new tab after animation
        setTimeout(() => {
            window.open(url, '_blank');
            card.style.transform = 'scale(1)';
        }, 300);
    }
    
    function createHeartAnimation(element) {
        const rect = element.getBoundingClientRect();
        const heart = document.createElement('div');
        heart.className = 'heart-animation';
        heart.innerHTML = '<i class="fas fa-heart"></i>';
        heart.style.left = (rect.left + rect.width/2) + 'px';
        heart.style.top = (rect.top) + 'px';
        document.body.appendChild(heart);
        
        setTimeout(() => {
            heart.remove();
        }, 1000);
    }
    
    function refreshTickets() {
        const refreshBtn = event.target.closest('button');
        refreshBtn.style.transform = 'rotate(180deg)';
        
        // Show loading
        showToast('Refreshing tickets...', 'info');
        
        setTimeout(() => {
            refreshBtn.style.transform = 'rotate(0)';
            setupFirebaseListener();
        }, 1000);
    }
    
    function showNotifications() {
        showToast('You have no new notifications', 'info');
    }
    
    // ==========================================
    // ADMIN FUNCTIONS
    // ==========================================
    function saveTicket() {
        const id = document.getElementById('docId').value;
        const title = document.getElementById('inpTitle').value.trim();
        const reply = document.getElementById('inpReply').value.trim();
        
        if (!title || !reply) {
            showToast('Please fill all required fields', 'error');
            return;
        }
        
        const data = {
            title: title,
            category: document.getElementById('inpCategory').value,
            keywords: document.getElementById('inpKeywords').value.toLowerCase(),
            note: document.getElementById('inpNote').value.trim(),
            reply: reply,
            sla: document.getElementById('inpSLA').value.trim(),
            order: 999,
            updatedAt: firebase.firestore.FieldValue.serverTimestamp()
        };
        
        if (!id) {
            data.timestamp = firebase.firestore.FieldValue.serverTimestamp();
            data.createdAt = firebase.firestore.FieldValue.serverTimestamp();
            data.likes = 0;
            data.shares = 0;
        }
        
        const saveBtn = document.getElementById('saveBtn');
        saveBtn.disabled = true;
        saveBtn.innerHTML = '<span class="loading-spinner"></span> Saving...';
        
        const promise = id 
            ? db.collection("tickets").doc(id).update(data)
            : db.collection("tickets").add(data);
        
        promise
            .then(() => {
                showToast(id ? 'Ticket updated!' : 'Ticket created!', 'success');
                clearForm();
                // Animation for new ticket
                if (!id) {
                    const cards = document.querySelectorAll('.insta-card');
                    if (cards.length > 0) {
                        cards[0].classList.add('swipe-left');
                        setTimeout(() => {
                            cards[0].classList.remove('swipe-left');
                        }, 300);
                    }
                }
            })
            .catch(error => {
                showToast('Error saving: ' + error.message, 'error');
            })
            .finally(() => {
                saveBtn.disabled = false;
                saveBtn.innerHTML = '<i class="fas fa-save"></i> <span id="saveBtnText">Save Ticket</span>';
            });
    }
    
    function editTicket(id) {
        const ticket = tickets.find(x => x.id === id);
        if (!ticket) return;
        
        document.getElementById('docId').value = ticket.id;
        document.getElementById('inpTitle').value = ticket.title || '';
        document.getElementById('inpCategory').value = ticket.category || 'code';
        document.getElementById('inpKeywords').value = ticket.keywords || '';
        document.getElementById('inpNote').value = ticket.note || '';
        document.getElementById('inpReply').value = ticket.reply || '';
        document.getElementById('inpSLA').value = ticket.sla || '';
        
        document.getElementById('adminPanel').style.display = 'block';
        document.getElementById('deleteBtn').style.display = 'flex';
        document.querySelector('.admin-title').innerHTML = '<i class="fas fa-edit"></i> Edit Ticket';
        
        // Smooth scroll to form
        document.getElementById('adminPanel').scrollIntoView({ 
            behavior: 'smooth',
            block: 'start'
        });
    }
    
    function deleteTicket() {
        const id = document.getElementById('docId').value;
        if (!id) return;
        
        if (!confirm('Delete this ticket? This cannot be undone.')) return;
        
        db.collection("tickets").doc(id).delete()
            .then(() => {
                showToast('Ticket deleted!', 'success');
                clearForm();
            })
            .catch(error => {
                showToast('Error deleting: ' + error.message, 'error');
            });
    }
    
    function clearForm() {
        document.getElementById('docId').value = '';
        document.getElementById('inpTitle').value = '';
        document.getElementById('inpCategory').value = 'sop';
        document.getElementById('inpKeywords').value = '';
        document.getElementById('inpNote').value = '';
        document.getElementById('inpReply').value = '';
        document.getElementById('inpSLA').value = '';
        
        document.getElementById('deleteBtn').style.display = 'none';
        document.querySelector('.admin-title').innerHTML = '<i class="fas fa-plus-circle"></i> Create New Ticket';
    }
    
    // ==========================================
    // AUTHENTICATION
    // ==========================================
    auth.onAuthStateChanged(user => {
        if (user) {
            isAdmin = true;
            document.getElementById('adminPanel').style.display = 'block';
            document.getElementById('authBtn').innerHTML = '<i class="fas fa-sign-out-alt"></i>';
            showToast('Welcome back, Admin!', 'success');
        } else {
            isAdmin = false;
            document.getElementById('adminPanel').style.display = 'none';
            document.getElementById('authBtn').innerHTML = '<i class="fas fa-user-cog"></i>';
        }
        renderTickets();
    });
    
    function toggleAuth() {
        if (isAdmin) {
            auth.signOut();
            showToast('Logged out successfully', 'info');
        } else {
            document.getElementById('loginModal').style.display = 'flex';
        }
    }
    
    function login() {
        const email = document.getElementById('email').value;
        const password = document.getElementById('password').value;
        
        if (!email || !password) {
            document.getElementById('loginError').textContent = 'Please enter email and password';
            document.getElementById('loginError').style.display = 'block';
            return;
        }
        
        const loginBtn = document.getElementById('loginBtn');
        loginBtn.disabled = true;
        document.getElementById('loginBtnText').style.display = 'none';
        document.getElementById('loginSpinner').style.display = 'inline-block';
        
        auth.signInWithEmailAndPassword(email, password)
            .then(() => {
                closeLoginModal();
            })
            .catch(error => {
                document.getElementById('loginError').textContent = error.message;
                document.getElementById('loginError').style.display = 'block';
                loginBtn.disabled = false;
                document.getElementById('loginBtnText').style.display = 'inline';
                document.getElementById('loginSpinner').style.display = 'none';
            });
    }
    
    function closeLoginModal() {
        document.getElementById('loginModal').style.display = 'none';
        document.getElementById('email').value = '';
        document.getElementById('password').value = '';
        document.getElementById('loginError').style.display = 'none';
    }
    
    // ==========================================
    // UTILITY FUNCTIONS
    // ==========================================
    function showToast(message, type = 'info') {
        const toast = document.getElementById('toast');
        const toastMessage = document.getElementById('toastMessage');
        
        // Set color based on type
        if (type === 'success') {
            toast.style.background = 'linear-gradient(135deg, #00B894, #00CEC9)';
        } else if (type === 'error') {
            toast.style.background = 'linear-gradient(135deg, #FF416C, #FF4B2B)';
        } else if (type === 'info') {
            toast.style.background = 'linear-gradient(135deg, #6C5CE7, #A29BFE)';
        }
        
        toastMessage.textContent = message;
        toast.classList.add('show');
        
        setTimeout(() => {
            toast.classList.remove('show');
        }, 3000);
    }
    
    function escapeHtml(text) {
        if (!text) return '';
        const div = document.createElement('div');
        div.textContent = text;
        return div.innerHTML;
    }
    
    function formatDate(date) {
        if (!date) return 'Recently';
        const now = new Date();
        const diffMs = now - date;
        const diffMins = Math.floor(diffMs / 60000);
        const diffHours = Math.floor(diffMs / 3600000);
        const diffDays = Math.floor(diffMs / 86400000);
        
        if (diffMins < 60) return `${diffMins}m ago`;
        if (diffHours < 24) return `${diffHours}h ago`;
        if (diffDays < 7) return `${diffDays}d ago`;
        return date.toLocaleDateString('ar-SA');
    }
    
    function getCategoryIcon(category) {
        const icons = {
            'sop': 'üí¨',
            'code': 'üîë',
            'login': 'üë§',
            'tech': 'üîß',
            'content': 'üìö',
            'inquiry': '‚ùì'
        };
        return icons[category] || 'üìù';
    }
    
    function getCategoryName(category) {
        const names = {
            'sop': 'SOP',
            'code': 'Code',
            'login': 'Login',
            'tech': 'Tech',
            'content': 'Content',
            'inquiry': 'Inquiry'
        };
        return names[category] || 'Other';
    }
    
    function getCategoryColor(category) {
        const colors = {
            'sop': 'linear-gradient(45deg, #f09433, #bc1888)',
            'code': 'linear-gradient(45deg, #405DE6, #5B86E5)',
            'login': 'linear-gradient(45deg, #00B894, #00CEC9)',
            'tech': 'linear-gradient(45deg, #FD1D1D, #FDCB6E)',
            'content': 'linear-gradient(45deg, #6C5CE7, #A29BFE)',
            'inquiry': 'linear-gradient(45deg, #E17055, #FD79A8)'
        };
        return colors[category] || 'linear-gradient(45deg, #636E72, #2D3436)';
    }
    
    // ==========================================
    // INITIALIZE
    // ==========================================
    document.addEventListener('DOMContentLoaded', function() {
        setupFirebaseListener();
        renderWebsites();
        
        // Close modal on ESC
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                closeLoginModal();
            }
        });
        
        // Close modal on outside click
        document.getElementById('loginModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeLoginModal();
            }
        });
        
        // Add floating animation to cards on load
        setTimeout(() => {
            const cards = document.querySelectorAll('.insta-card');
            cards.forEach((card, index) => {
                setTimeout(() => {
                    card.style.animationDelay = `${index * 0.1}s`;
                }, 0);
            });
        }, 100);
    });
</script>

</body>
</html>
